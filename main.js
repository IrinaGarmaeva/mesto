(()=>{"use strict";const e=document.querySelector(".button_type_edit"),t=document.querySelector(".button_type_add"),s=document.querySelector(".popup__input_el_name"),n=document.querySelector(".popup__input_el_job");class r{constructor(e,t,s){this._name=e.name,this._link=e.link,this._templateSelector=t,this._handleCardClick=s}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".place").cloneNode(!0)}_handleCardLike(){this._buttonLike.classList.toggle("place__like-button_active")}_handleDeleteCard(){this._element.remove(),this._element=null}_setEventListeners(){this._buttonLike.addEventListener("click",(()=>{this._handleCardLike()})),this._buttonDeleteBasket.addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardImage.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}generateCard(){return this._element=this._getTemplate(),this._buttonLike=this._element.querySelector(".place__like-button"),this._buttonDeleteBasket=this._element.querySelector(".place__delete-button"),this._cardImage=this._element.querySelector(".place__photo"),this._setEventListeners(),this._cardImage.src=this._link,this._element.querySelector(".place__name").textContent=this._name,this._cardImage.alt=this._name,this._element}}class o{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._errorClass=e.errorClass,this._inpitErrorClass=e.inpitErrorClass,this._formListSelector=e.formSelector,this._config=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonSubmit=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._formElement.querySelector(`.${e.name}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.name}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}disableButton(){this._buttonSubmit.setAttribute("disabled","disabled"),this._buttonSubmit.classList.add(this._inactiveButtonClass)}enableButton(){this._buttonSubmit.removeAttribute("disabled"),this._buttonSubmit.classList.remove(this._inactiveButtonClass)}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this.enableButton()}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}clearInputError(){this._inputList.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}class i{constructor(e){this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("mousedown",(e=>{e.target.classList.contains("popup_opened")&&this.close()}))}}class a extends i{constructor({popupSelector:e,callbackSubmitForm:t}){super(e),this._callbackSubmitForm=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=this._popup.querySelectorAll(".popup__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._callbackSubmitForm(this._getInputValues()),this.close()}))}close(){super.close(),this._form.reset()}}const p=new class{constructor({userNameSelector:e,userOccupationSelector:t}){this._userName=document.querySelector(e),this._userOccupation=document.querySelector(t)}getUserInfo(){return{name:this._userName.textContent,occupation:this._userOccupation.textContent}}setUserInfo({newUserName:e,newUserOccupation:t}){this._userName.textContent=e,this._userOccupation.textContent=t,console.log(e)}}({userNameSelector:".profile__name",userOccupationSelector:".profile__about"}),l=new a({popupSelector:".popup_type_edit-profile",callbackSubmitForm:e=>{const{"popup-username":t,"popup-job":s}=e;p.setUserInfo({newUserName:t,newUserOccupation:s})}});l.setEventListeners(),e.addEventListener("click",(()=>{l.open();const{name:e,occupation:t}=p.getUserInfo();s.value=e,n.value=t,h["profile-form"].clearInputError(),h["profile-form"].enableButton()}));const c=new a({popupSelector:".popup_type_add-place",callbackSubmitForm:e=>{const{"popup-place":t,"popup-link":s}=e;d({name:t,link:s})}});c.setEventListeners(),t.addEventListener("click",(()=>{c.open(),h["place-form"].clearInputError(),h["place-form"].disableButton()}));const u=new class extends i{constructor(e){super(e),this._popupImage=this._popup.querySelector(".popup__photo"),this._popupHeading=this._popup.querySelector(".popup__heading")}open({name:e,link:t}){super.open(),this._popupImage.src=t,this._popupHeading.textContent=e,this._popupImage.alt=e}}(".popup_type_open-image");u.setEventListeners();const _=new class{constructor({items:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:d},".places");function d(e){const t=new r(e,"#cardTemplate",(()=>{u.open({name:e.name,link:e.link})})).generateCard();_.addItem(t)}_.renderItems();const h={};var m;m={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",errorClass:"popup__input-error_active",inputErrorClass:"popup__input_invalid"},Array.from(document.querySelectorAll(m.formSelector)).forEach((e=>{const t=new o(m,e),s=e.getAttribute("name");h[s]=t,t.enableValidation()})),console.log(h)})();